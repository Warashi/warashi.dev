+++
title = "GitOps"
date = 2019-02-24T14:24:46+09:00
aliases = ["/post/2019/02/24/gitops"]
draft = false
type = "post"
+++

このブログ更新するのすごい久しぶりだ…… :thinking:

GitOpsというやつを知って、やってみたいなって思ったんですね。で、GitHub Pagesって特定のbranchの中身が常に反映されるわけじゃないですか。これはGitOpsにぴったりなのでは！と思ってこのブログをGitOpsっぽくしました。

具体的には、記事を書く際には `source` branch に向けてPRを作ります。この時点ではまだmarkdownファイルとかで書かれています。このPRがマージされると、CircleCI上でHugoを動かして `master` branchに向けたPRを自動で作ります。このPRにはHTMLファイルなどのHugoの成果物が入っています。

で、最終確認をした後にこのPRをマージするとGitHub Pagesに反映されるってわけです。2回PRをマージしないといけないですけど、実際に出力されるHTMLの差分を確認してから反映することで何かうれしいことがあるかもしれない？ないかもしれないけど。ないかもしれないって思ったんだけど、テーマ変えたりしてリニューアル作業をしていたらちょっとしたことでHugoの成果物が壊れてしまって、それを公開する前に気づけたのでやっぱりこの方式は有用だってことを確認できた。

上にも書いたけど、久しぶりに更新するついでにHugoのテーマも変えときました。
